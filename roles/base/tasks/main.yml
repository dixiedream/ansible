# Load distro specific variables
- include_vars: "{{ ansible_distribution }}.yml"
  when: ansible_system == "Linux"

- name: Linux setup
  become: true
  block:
    - import_tasks: users/ale.yml

    - import_tasks: ansible_setup.yml

    - import_tasks: packages/debloat_debian.yml
      when: ansible_os_family == "Debian"

    - import_tasks: packages/install_aur_helper.yml
      when: ansible_os_family == "Archlinux"

    - import_tasks: packages/install_packages.yml
    - import_tasks: packages/install_autocpufreq.yml
    - import_tasks: packages/install_brave.yml
    - import_tasks: packages/install_libxft.yml
    - import_tasks: packages/install_nordic_theme.yml
    - import_tasks: packages/install_dwm.yml
    - import_tasks: packages/install_st.yml
    - import_tasks: packages/install_dmenu.yml

    - import_tasks: system_setup/network.yml
    - import_tasks: system_setup/locale.yml
    - import_tasks: system_setup/microcode.yml # Need to set that as kernel par
    - import_tasks: system_setup/tap_to_click.yml

    - import_tasks: system_setup/pacman.yml
      when: ansible_distribution == "Archlinux"

    - import_tasks: system_setup/dotfiles.yml
    - import_tasks: system_setup/remove_beep.yml
    - import_tasks: system_setup/lock_on_suspend.yml

    - import_tasks: system_setup/debian_systemctl_shortcuts.yml
      when: ansible_os_family == "Debian"

      # Only for laptops
    - import_tasks: system_setup/battery_threshold.yml
      when: ansible_form_factor == "Notebook"
  when: ansible_system == "Linux"

- name: Setup MacOS
  block:
    - import_tasks: mac_os/activity_monitor.yml
    - import_tasks: mac_os/address_book.yml
    - import_tasks: mac_os/dashboard.yml
    - import_tasks: mac_os/disk_utility.yml
    - import_tasks: mac_os/dock.yml
    - import_tasks: mac_os/finder.yml
    - import_tasks: mac_os/global.yml
    - import_tasks: mac_os/hot_corners.yml
    - import_tasks: mac_os/locale.yml
    - import_tasks: mac_os/mac_app_store.yml
    - import_tasks: mac_os/mail.yml
    - import_tasks: mac_os/messages.yml
    - import_tasks: mac_os/photos.yml

    - import_tasks: mac_os/power_management.yml
      when: ansible_form_factor is defined and ansible_form_factor == "Notebook"

    - import_tasks: mac_os/quicktime.yml
    - import_tasks: mac_os/safari.yml
    - import_tasks: mac_os/screen.yml
    - import_tasks: mac_os/spotlight.yml
    - import_tasks: mac_os/tap_to_click.yml
    - import_tasks: mac_os/terminal.yml
    - import_tasks: mac_os/text_edit.yml
    - import_tasks: mac_os/time_machine.yml

    - import_tasks: system_setup/dotfiles.yml
  when: ansible_os_family == "Darwin"
