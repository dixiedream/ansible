- name: packages
  become: true
  block:
    - name: packages | ensure pipewire-media-session is not present
      package:
        name: pipewire-media-session
        state: absent
      ignore_errors: yes
      when: ansible_distribution in ["Archlinux", "Debian"]

    - name: packages | install common packages
      package:
        name:
          - atool
          - bc
          - bleachbit
          - cmus
          - dosfstools
          - exfatprogs
          - fzf
          - gzip
          - htop
          - imagemagick
          - mpv
          - ncdu
          - neofetch
          - ntfs-3g
          - p7zip
          - ripgrep
          - s-tui
          - "{{ unrar_package }}"
          - unzip
          - yt-dlp
          - zathura
          - "{{ zathura_pdf_support_package }}"
          - zip
          - zsh
        state: latest

    - name: packages | install packages for window managers
      package:
        name:
          - "{{ acpi_call_package }}"
          - bluez
          - "{{ bluez_utils_package }}"
          - brightnessctl
          - "{{ libnotify_package }}"
          - man-db
          - "{{ noto_fonts_package }}"
          - "{{ noto_fonts_emoji_package }}"
          - pavucontrol
          - pipewire
          - pipewire-alsa
          - pipewire-pulse
          - playerctl
          - wireplumber
          - "{{ wpa_supplicant_package }}"
        state: latest
        when: ansible_distribution in ["Archlinux", "Debian"]

    - name: packages | install Pacman Contrib package (Archlinux)
      pacman:
        name:
          - pacman-contrib
        state: latest
      when: ansible_distribution == "Archlinux"

    - name: packages | install polkit package (Archlinux)
      pacman:
        name:
          - polkit
        state: latest
      when: ansible_distribution == "Archlinux"

    - name: packages | install Bluetooth related stuff (Debian)
      apt:
        name:
          - bluetooth
          - bluez-firmware
          - libspa-0.2-bluetooth
        state: latest
      when: ansible_distribution == "Debian"
