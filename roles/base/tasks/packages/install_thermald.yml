---
- name: packages | Thermald
  become: true
  when: ansible_form_factor is defined and ansible_form_factor == "Notebook" and ansible_distribution not in ['Pop!_OS', 'Ubuntu']
  block:
    - name: packages | thermald | install package
      ansible.builtin.package:
        name:
          - thermald
        state: latest

    - name: packages | thermald | install runit package
      ansible.builtin.package:
        name:
          - thermald-runit
        state: latest
      when: ansible_service_mgr != 'systemd'

    - name: packages | thermald | enable service (Runit)
      ansible.builtin.command: ln --symbolic --force /etc/runit/sv/thermald /run/runit/service/
      when: ansible_service_mgr != 'systemd'

    - name: packages | thermald | enable service (Systemd)
      ansible.builtin.service:
        name: thermald
        state: started
        enabled: true
      when: ansible_service_mgr == 'systemd'
