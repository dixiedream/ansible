- name: system setup | dotfiles | Linux
  become_user: ale
  block:
    - name: system setup | dotfiles | Clone repo
      git:
        bare: yes
        repo: https://github.com/dixiedream/dotfiles.git
        dest: "{{ dotfile_src }}"

    - name: system setup | dotfiles | Setup repo
      command: "git --git-dir={{ dotfile_src }} --work-tree='{{ user_home }}' checkout -f dwm"

    - name: system setup | dotfiles | Setup repo
      command: "git --git-dir={{ dotfile_src }} --work-tree='{{ user_home }}' config --local status.showUntrackedFiles no"

    - name: system setup | dotfiles | Setup repo
      command: "git --git-dir={{ dotfile_src }} --work-tree='{{ user_home }}' config remote.origin.url 'git@github.com:dixiedream/dotfiles.git'"

    - name: system setup | dotfiles | Setup repo
      command: "git --git-dir={{ dotfile_src }} --work-tree='{{ user_home }}' config remote.origin.fetch 'refs/heads/*:refs/remotes/origin/*'"
  when: ansible_system == "Linux"

- name: system setup | dotfiles | MacOS
  block:
    - name: system setup | dotfiles | Clone repo
      git:
        bare: yes
        repo: https://github.com/dixiedream/dotfiles.git
        dest: "~/.cfg"

    - name: system setup | dotfiles | Setup repo
      command: "git --git-dir='~/.cfg' --work-tree='~' checkout -f dwm"

    - name: system setup | dotfiles | Setup repo
      command: "git --git-dir='~/.cfg' --work-tree='~' config --local status.showUntrackedFiles no"

    - name: system setup | dotfiles | Setup repo
      command: "git --git-dir='~/.cfg' --work-tree='~' config remote.origin.url 'git@github.com:dixiedream/dotfiles.git'"

    - name: system setup | dotfiles | Setup repo
      command: "git --git-dir='~/.cfg' --work-tree='~' config remote.origin.fetch 'refs/heads/*:refs/remotes/origin/*'"
  when: ansible_system == "Darwin"
